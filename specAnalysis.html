<div id="specAnalysisBox">
    <div class="d-flex justify-content-evenly">
        <div class="row-cols-3" id="spec-container">상세스펙(유물 안낀 기준 입력)
        </div>
        <div class="row-cols-3" id="skill-container">스킬
        </div>
        <div class="row-cols-3" id="familiar-container">사역마
        </div>
    </div>
    <br>
    <div class="d-flex justify-content-evenly">
        <div class="row-cols-2" id="relicsSet-container"><b>유물 장착 별 보스 데미지 비율(자물쇠 유물의 경우 스킬 5개만 계산 됨)</b>
            <div id="nameBox" class="col-auto p-0 small"></div>
        </div>
        <div class="row-cols-2"  id="relics-container"><b>유물 개별 딜량 증가량</b>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        var specContainer = document.getElementById('spec-container');
        var skillContainer = document.getElementById('skill-container');
        var familiarContainer = document.getElementById('familiar-container');
        var relicsSetContainer = document.getElementById('relicsSet-container');
        var relicsContainer = document.getElementById('relics-container');

        createInputGroup(specContainer, dataSetSpec);
        createInputGroup(skillContainer, dataSetSkill);
        createInputGroup(familiarContainer, dataSetFamiliar);
        createInputGroupResult(relicsSetContainer, dataSetRelicsSet);
        createInputGroupResult(relicsContainer, dataSetRelics);

        function createInputGroup(container, items) {
            items.forEach(function (item) {
                var div = document.createElement('div');
                div.className = 'input-group input-group-sm col-auto p-0';

                var span = document.createElement('span');
                span.className = 'input-group-text col-6 rank-' + item.ranks;
                span.id = 'inputGroup-sizing-sm';
                span.textContent = item.name;

                var input = document.createElement('input');
                input.type = 'number';
                input.className = 'form-control';
                input.setAttribute('aria-label', 'Sizing example input');
                input.setAttribute('aria-describedby', 'inputGroup-sizing-sm');
                input.name = item.key;
                input.id = item.key;
                input.value = item.value;

                // 이벤트 리스너 추가
                input.addEventListener('change', function () {
                    bossSetResult();
                });

                div.appendChild(span);
                div.appendChild(input);
                container.appendChild(div);
            });
        }

        function createInputGroupResult(container, items) {
            items.forEach(function (item) {
                var div = document.createElement('div');
                div.className = 'input-group input-group-sm col-auto p-0';

                var span = document.createElement('span');
                span.className = 'input-group-text col-10 rank-' + item.ranks;
                span.id = 'inputGroup-sizing-sm';
                span.textContent = item.name;

                var input = document.createElement('input');
                input.type = 'text';
                input.className = 'form-control';
                input.setAttribute('aria-label', 'Sizing example input');
                input.setAttribute('aria-describedby', 'inputGroup-sizing-sm');

                input.name = item.key;
                input.id = item.key;
                input.readOnly = true;

                div.appendChild(span);
                div.appendChild(input);
                container.appendChild(div);
            });
        }

        function calculateValue(data, levelData, meteorRelics = false) {
            return data.map(function (item) {
                var level = parseFloat(levelData.find(function (levelItem) {
                    return levelItem.key === item.key;
                }).level);
                if(meteorRelics && item.key == "meteor") {
                    var value = ((parseFloat(item.default) + parseFloat(item.growth) * (level - 1))+1550) * parseFloat(item.hits) / parseFloat(item.cool_time);
                }else {
                    var value = (parseFloat(item.default) + parseFloat(item.growth) * (level - 1)) * parseFloat(item.hits) / parseFloat(item.cool_time);
                }


                return {
                    "key": item.key,
                    "name": item.name,
                    "default": item.default,
                    "growth": item.growth,
                    "hits": item.hits,
                    "cool_time": item.cool_time,
                    "level": level,
                    "value": value
                };
            });
        }

        function getTopData(data, rank) {
            // 데이터를 value 기준으로 내림차순 정렬
            data.sort(function (a, b) {
                return b.value - a.value;
            });

            // 상위 rank개의 데이터를 추출
            var topData = data.slice(0, rank);

            return topData;
        }





        function calculateDamage(entity, parameters, _criticalHitProbability, _criticalDamage, _cooldown, _damage ,meteorRelics) {
            if(meteorRelics && entity.key == "meteor") {
                debugger
                var value = ((parseFloat(entity.default) + parseFloat(entity.growth) * (entity.level - 1))+1550) * parseFloat(entity.hits);
            }else {
                var value = (parseFloat(entity.default) + parseFloat(entity.growth) * (entity.level - 1)) * parseFloat(entity.hits);
            }

            var cooldown = parseFloat(entity.cool_time) * (1 - (_cooldown / 100));
            var criticalHitMultiplier = _criticalHitProbability >= 100 ? _criticalDamage : _criticalDamage / _criticalHitProbability;
            var totalDamage = parameters.attackPower * criticalHitMultiplier * _damage * parameters.bossMonsterDamage * parameters.finalDamage * value / cooldown;
            return totalDamage;
        }

        function calculateTopDamage(topData, parameters, _criticalHitProbability, _criticalDamage, _cooldown, _damage, meteorRelics = false) {
            return topData.map(function (entity) {
                var totalDamage = calculateDamage(entity, parameters, _criticalHitProbability, _criticalDamage, _cooldown, _damage, meteorRelics);
                return {
                    "name": entity.name,
                    "damage": totalDamage
                };
            });
        }


        function calculateTotalDPS(damageData) {
            var totalDPS = 0;
            damageData.forEach(function (item) {
                totalDPS += item.damage;
            });
            return totalDPS;
        }


        function bossSetResult() {
            var parameters = {
                "attackPower": parseFloat($("#_attackPower").val()), // 공격력
                "skillCriticalHitProbability": parseFloat($("#_skillCriticalHitProbability").val()), // 스킬 치명타 확률
                "skillCriticalDamage": parseFloat($("#_skillCriticalDamage").val()), // 스킬 치명타 피해량
                "skillCooldown": parseFloat($("#_skillCooldown").val()), // 스킬 쿨타임
                "skillDamage": parseFloat($("#_skillDamage").val()), // 스킬 피해량
                "familiarCriticalHitProbability": parseFloat($("#_familiarCriticalHitProbability").val()), // 사역마 치명타 확률
                "familiarCriticalDamage": parseFloat($("#_familiarCriticalDamage").val()), // 사역마 치명타 피해량
                "familiarCooldown": parseFloat($("#_familiarCooldown").val()), // 사역마 쿨타임
                "familiarDamage": parseFloat($("#_familiarDamage").val()), // 사역마 피해량
                "normalMonsterDamage": parseFloat($("#_normalMonsterDamage").val()), // 일반 몬스터 피해량
                "bossMonsterDamage": parseFloat($("#_bossMonsterDamage").val()), // 보스 몬스터 피해량
                "finalDamage": parseFloat($("#_finalDamage").val()) // 최종 피해량
            };

            var _skillLevel = [
                {"key": "slash", "level": $("#slash").val()},
                {"key": "magicSphere", "level": $("#magicSphere").val()},
                {"key": "skullPress", "level": $("#skullPress").val()},
                {"key": "lightning", "level": $("#lightning").val()},
                {"key": "crowFeather", "level": $("#crowFeather").val()},
                {"key": "energyBall", "level": $("#energyBall").val()},
                {"key": "icicle", "level": $("#icicle").val()},
                {"key": "poisonMushroom", "level": $("#poisonMushroom").val()},
                {"key": "swordMaster", "level": $("#swordMaster").val()},
                {"key": "aquaBall", "level": $("#aquaBall").val()},
                {"key": "dancingSword", "level": $("#dancingSword").val()},
                {"key": "crystalBlaster", "level": $("#crystalBlaster").val()},
                {"key": "ogreFoot", "level": $("#ogreFoot").val()},
                {"key": "thornLurker", "level": $("#thornLurker").val()},
                {"key": "bat", "level": $("#bat").val()},
                {"key": "hydraBreath", "level": $("#hydraBreath").val()},
                {"key": "blackHole", "level": $("#blackHole").val()},
                {"key": "meteor", "level": $("#meteor").val()},
                {"key": "cometSpear", "level": $("#cometSpear").val()},
                {"key": "lightWave", "level": $("#lightWave").val()},
                {"key": "demonEye", "level": $("#demonEye").val()}
            ];

            var _familiarLevel = [
                {"key": "lily", "level": $("#lily").val()},
                {"key": "fuzzy", "level": $("#fuzzy").val()},
                {"key": "bats", "level": $("#bats").val()},
                {"key": "kurg", "level": $("#kurg").val()},
                {"key": "tweety", "level": $("#tweety").val()},
                {"key": "butterfly", "level": $("#butterfly").val()},
                {"key": "leila", "level": $("#leila").val()},
                {"key": "hamji", "level": $("#hamji").val()},
                {"key": "ready", "level": $("#ready").val()},
                {"key": "tony", "level": $("#tony").val()},
                {"key": "crow", "level": $("#crow").val()},
                {"key": "jeolmi", "level": $("#jeolmi").val()},
                {"key": "blueA", "level": $("#blueA").val()},
                {"key": "rh42", "level": $("#rh42").val()},
                {"key": "icy", "level": $("#icy").val()},
                {"key": "alpha", "level": $("#alpha").val()},
                {"key": "lupin", "level": $("#lupin").val()},
                {"key": "leo", "level": $("#leo").val()},
                {"key": "basil", "level": $("#basil").val()},
                {"key": "tot", "level": $("#tot").val()},
                {"key": "spark", "level": $("#spark").val()},
                {"key": "brazen", "level": $("#brazen").val()},
                {"key": "nox", "level": $("#nox").val()},
                {"key": "cheese", "level": $("#cheese").val()},
                {"key": "aurora", "level": $("#aurora").val()},
                {"key": "rockn", "level": $("#rockn").val()},
                {"key": "coco", "level": $("#coco").val()},
                {"key": "beta", "level": $("#beta").val()},
                {"key": "apollo", "level": $("#apollo").val()},
                {"key": "jelly", "level": $("#jelly").val()}
            ];

            //레벨에 따른 데미지 값 구하기
            var _skillValue = calculateValue(dataSetSkill, _skillLevel);
            var _skillValueMeteor = calculateValue(dataSetSkill, _skillLevel, true);
            var _familiarValue = calculateValue(dataSetFamiliar, _familiarLevel);

            //구한 데미지 값 중 상위 랭킹 추출
            var top6SkillData = getTopData(_skillValue, 6);
            var top5SkillData = getTopData(_skillValue, 5);
            var top6SkillDataMeteor = getTopData(_skillValueMeteor, 6);
            var top5SkillDataMeteor = getTopData(_skillValueMeteor, 5);
            var top4FamiliarData = getTopData(_familiarValue, 4);

            $("#nameBox").empty();
            $("#nameBox").append("채용된 스킬 : ");
            for (var i = 0; i < top6SkillData.length; i++) {
                if (i === top6SkillData.length - 1) { // 마지막 요소인 경우
                    $("#nameBox").append(top6SkillData[i].name);
                } else {
                    $("#nameBox").append(top6SkillData[i].name + ", ");
                }
            }
            $("#nameBox").append('<br>');
            $("#nameBox").append("채용된 스킬(붉은 공명석) : ");
            for (var i = 0; i < top6SkillDataMeteor.length; i++) {
                if (i === top6SkillDataMeteor.length - 1) { // 마지막 요소인 경우
                    $("#nameBox").append(top6SkillDataMeteor[i].name);
                } else {
                    $("#nameBox").append(top6SkillDataMeteor[i].name + ", ");
                }
            }
            $("#nameBox").append('<br>');
            $("#nameBox").append("채용된 사역마 : ");
            for (var i = 0; i < top4FamiliarData.length; i++) {
                if (i === top4FamiliarData.length - 1) { // 마지막 요소인 경우
                    $("#nameBox").append(top4FamiliarData[i].name);
                } else {
                    $("#nameBox").append(top4FamiliarData[i].name + ", ");
                }
            }

            // 상위 랭킹의 DPS 값 구하기
            //var top6skillDPS = calculateTopDamage(top6SkillData, parameters, parameters.skillCriticalHitProbability,parameters.skillCriticalDamage,parameters.skillCooldown,parameters.skillDamage);
            //var top4familiarDPS = calculateTopDamage(top4FamiliarData, parameters,parameters.familiarCriticalHitProbability, parameters.familiarCriticalDamage, parameters.familiarCooldown, parameters.familiarDamage);


            var modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            var top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            var top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            //총 DPS값 구하기
            var totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relicsSet1 = totalDPS;
            $("#relicsSet1").val((relicsSet1 / relicsSet1 * 100).toFixed(2) + "%");

            //지도5,마법서5,네크로5,슬라임조각5
            var modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.skillCriticalDamage += 200;
            modifiedParameters.skillDamage += 1600;
            var top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            modifiedParameters.familiarCriticalDamage += 200;
            modifiedParameters.familiarDamage += 1600;
            var top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            var totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relicsSet2 = totalDPS;
            $("#relicsSet2").val((relicsSet2 / relicsSet1 * 100).toFixed(2) + "%");

            //큐브1
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.bossMonsterDamage += 10;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relicsSet3 = totalDPS;
            $("#relicsSet3").val((relicsSet3 / relicsSet1 * 100).toFixed(2) + "%");

            //큐브2
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.bossMonsterDamage += 20;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relicsSet4 = totalDPS;
            $("#relicsSet4").val((relicsSet4 / relicsSet1 * 100).toFixed(2) + "%");

            //큐브3
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.bossMonsterDamage += 30;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relicsSet5 = totalDPS;
            $("#relicsSet5").val((relicsSet5 / relicsSet1 * 100).toFixed(2) + "%");

            //큐브4
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.bossMonsterDamage += 40;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relicsSet6 = totalDPS;
            $("#relicsSet6").val((relicsSet6 / relicsSet1 * 100).toFixed(2) + "%");

            //큐브5
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.bossMonsterDamage += 50;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relicsSet7 = totalDPS;
            $("#relicsSet7").val((relicsSet7 / relicsSet1 * 100).toFixed(2) + "%");

            var excessskillProbability = parameters.skillCriticalHitProbability > 100 ? Math.floor(parameters.skillCriticalHitProbability - 100) : 0;
            var excessfamiliarProbability = parameters.familiarCriticalHitProbability > 100 ? Math.floor(parameters.familiarCriticalHitProbability - 100) : 0;

            //꿈룬5,맹반5,보검5,뇌전5
            var modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.skillCriticalDamage += (excessskillProbability + 50) * 30;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            modifiedParameters.familiarCriticalDamage += (excessfamiliarProbability + 30) * 30;
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relicsSet8 = totalDPS;
            $("#relicsSet8").val((relicsSet8 / relicsSet1 * 100).toFixed(2) + "%");

            //꿈룬5,맹반5,보검5,인형5
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.skillCriticalDamage += (excessskillProbability + 30) * 30;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            modifiedParameters.familiarCriticalDamage += (excessfamiliarProbability + 50) * 30;
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relicsSet9 = totalDPS;
            $("#relicsSet9").val((relicsSet9 / relicsSet1 * 100).toFixed(2) + "%");

            //꿈룬5,맹반5,뇌전5,꼬리5
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.skillCriticalDamage += (excessskillProbability + 62) * 30;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relicsSet10 = totalDPS;
            $("#relicsSet10").val((relicsSet10 / relicsSet1 * 100).toFixed(2) + "%");

            //꿈룬5,맹반5,뇌전5,지도5
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.skillCriticalDamage += (excessskillProbability + 50) * 30 + 200;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relicsSet11 = totalDPS;
            $("#relicsSet11").val((relicsSet11 / relicsSet1 * 100).toFixed(2) + "%");

            //꿈룬5,맹반5,뇌전5,자물쇠
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.skillCriticalDamage += (excessskillProbability + 50) * 30;
            modifiedParameters.skillCooldown += 5;
            var top5skillDPS = calculateTopDamage(top5SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top5skillDPS.concat(top4familiarDPS));
            var relicsSet12 = totalDPS;
            $("#relicsSet12").val((relicsSet12 / relicsSet1 * 100).toFixed(2) + "%");

            //꿈룬5,맹반5,붉은 공명석,자물쇠
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.skillCriticalDamage += (excessskillProbability + 50) * 30;
            modifiedParameters.skillCooldown += 5;
            var top5skillDPS = calculateTopDamage(top5SkillDataMeteor, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top5skillDPS.concat(top4familiarDPS));
            var relicsSet17 = totalDPS;
            $("#relicsSet17").val((relicsSet17 / relicsSet1 * 100).toFixed(2) + "%");

            //맹반5,지도5,꼬리5,뇌전5
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.skillCriticalDamage += (excessskillProbability + 32) * 30 + 200;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relicsSet13 = totalDPS;
            $("#relicsSet13").val((relicsSet13 / relicsSet1 * 100).toFixed(2) + "%");

            //맹반5,꼬리5,뇌전5,자물쇠
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.skillCriticalDamage += (excessskillProbability + 32) * 30;
            modifiedParameters.skillCooldown += 5;
            top5skillDPS = calculateTopDamage(top5SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top5skillDPS.concat(top4familiarDPS));
            var relicsSet14 = totalDPS;
            $("#relicsSet14").val((relicsSet14 / relicsSet1 * 100).toFixed(2) + "%");

            //맹반5,보검5,인형5,뇌전5
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.skillCriticalDamage += (excessskillProbability + 20) * 30;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            modifiedParameters.familiarCriticalDamage += (excessfamiliarProbability + 20) * 30;
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relicsSet15 = totalDPS;
            $("#relicsSet15").val((relicsSet15 / relicsSet1 * 100).toFixed(2) + "%");

            //꿈룬,보검,인형,슬라임조각
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.familiarCriticalDamage += (excessfamiliarProbability + 50) * 30 + 200;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relicsSet16 = totalDPS;
            $("#relicsSet16").val((relicsSet16 / relicsSet1 * 100).toFixed(2) + "%");

            // 유물 개별 딜량 증가량
            // 셀러맨더 꼬리
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.skillCriticalDamage += 12 * 30;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relics1 = totalDPS;
            $("#relics1").val((relics1 / relicsSet1 * 100).toFixed(2) + "%");

            // 대해적의 보물 지도
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.skillCriticalDamage += 200;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relics2 = totalDPS;
            $("#relics2").val((relics2 / relicsSet1 * 100).toFixed(2) + "%");

            // 강화 슬라임 조각
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.familiarCriticalDamage += 200;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relics3 = totalDPS;
            $("#relics3").val((relics3 / relicsSet1 * 100).toFixed(2) + "%");

            // 평범한 자물쇠
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.skillCooldown += 5;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relics4 = totalDPS;
            $("#relics4").val((relics4 / relicsSet1 * 100).toFixed(2) + "%");

            // 붉은 공명석
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            top6skillDPS = calculateTopDamage(top6SkillDataMeteor, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage, true);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relics5 = totalDPS;
            $("#relics5").val((relics5 / relicsSet1 * 100).toFixed(2) + "%");

            // 뇌전의 깃털
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.skillCriticalDamage += 20 * 30;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relics6 = totalDPS;
            $("#relics6").val((relics6 / relicsSet1 * 100).toFixed(2) + "%");

            // 버려진 애착 인형
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.familiarCriticalDamage += 20 * 30;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relics7 = totalDPS;
            $("#relics7").val((relics7 / relicsSet1 * 100).toFixed(2) + "%");

            // 고대 마법서
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.skillDamage += 1600;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relics8 = totalDPS;
            $("#relics8").val((relics8 / relicsSet1 * 100).toFixed(2) + "%");

            // 네크로노미콘
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.familiarDamage += 1600;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relics9 = totalDPS;
            $("#relics9").val((relics9 / relicsSet1 * 100).toFixed(2) + "%");

            // 미확인 큐브
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.bossMonsterDamage += 50;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relics10 = totalDPS;
            $("#relics10").val((relics10 / relicsSet1 * 100).toFixed(2) + "%");

            // 영웅의 낡은 보검
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            modifiedParameters.familiarCriticalDamage += excessfamiliarProbability * 30;
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relics11 = totalDPS;
            $("#relics11").val((relics11 / relicsSet1 * 100).toFixed(2) + "%");

            // 맹수의 반지
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.skillCriticalDamage += excessskillProbability* 30;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relics12 = totalDPS;
            $("#relics12").val((relics12 / relicsSet1 * 100).toFixed(2) + "%");

            // 꿈의 룬 조각(맹반)
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.skillCriticalDamage += 30 * 30;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relics13 = totalDPS;
            $("#relics13").val((relics13 / relicsSet1 * 100).toFixed(2) + "%");

            // 꿈의 룬 조각(보검)
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.familiarCriticalDamage += 30 * 30;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relics14 = totalDPS;
            $("#relics14").val((relics14 / relicsSet1 * 100).toFixed(2) + "%");


            // 꿈의 룬 조각(맹반, 보검)
            modifiedParameters = JSON.parse(JSON.stringify(parameters)); // parameters 객체 복사
            modifiedParameters.skillCriticalDamage += 30 * 30;
            modifiedParameters.familiarCriticalDamage += 30 * 30;
            top6skillDPS = calculateTopDamage(top6SkillData, modifiedParameters, modifiedParameters.skillCriticalHitProbability, modifiedParameters.skillCriticalDamage, modifiedParameters.skillCooldown, modifiedParameters.skillDamage);
            top4familiarDPS = calculateTopDamage(top4FamiliarData, modifiedParameters, modifiedParameters.familiarCriticalHitProbability, modifiedParameters.familiarCriticalDamage, modifiedParameters.familiarCooldown, modifiedParameters.familiarDamage);
            totalDPS = calculateTotalDPS(top6skillDPS.concat(top4familiarDPS));
            var relics15 = totalDPS;
            $("#relics15").val((relics15 / relicsSet1 * 100).toFixed(2) + "%");




        }

    });
</script>